{"ast":null,"code":"import{useState,useEffect,useCallback}from'react';import{AssessmentEngine}from'../engine/AssessmentEngine';export const useAssessment=assessmentType=>{const[engine,setEngine]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[currentStage,setCurrentStage]=useState(null);const[progress,setProgress]=useState(0);useEffect(()=>{const initializeAssessment=async()=>{try{setLoading(true);const assessmentEngine=new AssessmentEngine(assessmentType);await assessmentEngine.initialize();setEngine(assessmentEngine);setCurrentStage(assessmentEngine.flow.getCurrentStage());updateProgress(assessmentEngine);}catch(err){setError(err.message);}finally{setLoading(false);}};if(assessmentType){initializeAssessment();}},[assessmentType]);const updateProgress=useCallback(assessmentEngine=>{const progressData=assessmentEngine.getProgress();setProgress(progressData.percentage);},[]);const nextStage=useCallback(async()=>{if(!engine)return;try{const nextStage=await engine.nextStage();setCurrentStage(nextStage);updateProgress(engine);}catch(err){setError(err.message);}},[engine,updateProgress]);const previousStage=useCallback(async()=>{if(!engine)return;try{const prevStage=await engine.previousStage();setCurrentStage(prevStage);updateProgress(engine);}catch(err){setError(err.message);}},[engine,updateProgress]);const saveResponse=useCallback((questionId,value)=>{if(!engine)return;engine.saveResponse(questionId,value);},[engine]);const getResponse=useCallback(questionId=>{if(!engine)return null;return engine.getResponse(questionId);},[engine]);const setContext=useCallback((key,value)=>{if(!engine)return;engine.setContext(key,value);},[engine]);const getContext=useCallback(key=>{if(!engine)return null;return engine.getContext().key;},[engine]);const calculateResults=useCallback(()=>{if(!engine)return null;return engine.calculateResults();},[engine]);const getAssessmentConfig=useCallback(async type=>{try{// Dynamically import the assessment configuration file\nconst config=await import(\"../../assessments/\".concat(type,\"/config.json\"));return config;}catch(err){console.error('Error loading assessment config:',err);throw new Error(\"Failed to load configuration for assessment type: \".concat(type));}},[]);const reset=useCallback(()=>{if(!engine)return;engine.reset();setCurrentStage(engine.flow.getCurrentStage());setProgress(0);},[engine]);return{loading,error,currentStage,progress,nextStage,previousStage,saveResponse,getResponse,setContext,getContext,calculateResults,reset,getAssessmentConfig};};export default useAssessment;","map":{"version":3,"names":["useState","useEffect","useCallback","AssessmentEngine","useAssessment","assessmentType","engine","setEngine","loading","setLoading","error","setError","currentStage","setCurrentStage","progress","setProgress","initializeAssessment","assessmentEngine","initialize","flow","getCurrentStage","updateProgress","err","message","progressData","getProgress","percentage","nextStage","previousStage","prevStage","saveResponse","questionId","value","getResponse","setContext","key","getContext","calculateResults","getAssessmentConfig","type","config","concat","console","Error","reset"],"sources":["/Users/jon/Documents/GitHub/assessor/src/core/hooks/useAssessment.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { AssessmentEngine } from '../engine/AssessmentEngine';\n\nexport const useAssessment = (assessmentType) => {\n    const [engine, setEngine] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [currentStage, setCurrentStage] = useState(null);\n    const [progress, setProgress] = useState(0);\n\n    useEffect(() => {\n        const initializeAssessment = async () => {\n            try {\n                setLoading(true);\n                const assessmentEngine = new AssessmentEngine(assessmentType);\n                await assessmentEngine.initialize();\n                setEngine(assessmentEngine);\n                setCurrentStage(assessmentEngine.flow.getCurrentStage());\n                updateProgress(assessmentEngine);\n            } catch (err) {\n                setError(err.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        if (assessmentType) {\n            initializeAssessment();\n        }\n    }, [assessmentType]);\n\n    const updateProgress = useCallback((assessmentEngine) => {\n        const progressData = assessmentEngine.getProgress();\n        setProgress(progressData.percentage);\n    }, []);\n\n    const nextStage = useCallback(async () => {\n        if (!engine) return;\n        \n        try {\n            const nextStage = await engine.nextStage();\n            setCurrentStage(nextStage);\n            updateProgress(engine);\n        } catch (err) {\n            setError(err.message);\n        }\n    }, [engine, updateProgress]);\n\n    const previousStage = useCallback(async () => {\n        if (!engine) return;\n        \n        try {\n            const prevStage = await engine.previousStage();\n            setCurrentStage(prevStage);\n            updateProgress(engine);\n        } catch (err) {\n            setError(err.message);\n        }\n    }, [engine, updateProgress]);\n\n    const saveResponse = useCallback((questionId, value) => {\n        if (!engine) return;\n        engine.saveResponse(questionId, value);\n    }, [engine]);\n\n    const getResponse = useCallback((questionId) => {\n        if (!engine) return null;\n        return engine.getResponse(questionId);\n    }, [engine]);\n\n    const setContext = useCallback((key, value) => {\n        if (!engine) return;\n        engine.setContext(key, value);\n    }, [engine]);\n\n    const getContext = useCallback((key) => {\n        if (!engine) return null;\n        return engine.getContext().key;\n    }, [engine]);\n\n    const calculateResults = useCallback(() => {\n        if (!engine) return null;\n        return engine.calculateResults();\n    }, [engine]);\n\n    const getAssessmentConfig = useCallback(async (type) => {\n        try {\n            // Dynamically import the assessment configuration file\n            const config = await import(`../../assessments/${type}/config.json`);\n            return config;\n        } catch (err) {\n            console.error('Error loading assessment config:', err);\n            throw new Error(`Failed to load configuration for assessment type: ${type}`);\n        }\n    }, []);\n\n    const reset = useCallback(() => {\n        if (!engine) return;\n        engine.reset();\n        setCurrentStage(engine.flow.getCurrentStage());\n        setProgress(0);\n    }, [engine]);\n\n    return {\n        loading,\n        error,\n        currentStage,\n        progress,\n        nextStage,\n        previousStage,\n        saveResponse,\n        getResponse,\n        setContext,\n        getContext,\n        calculateResults,\n        reset,\n        getAssessmentConfig\n    };\n};\n\nexport default useAssessment;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}