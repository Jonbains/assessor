{"ast":null,"code":"/**\n * In-House Marketing Scoring Engine\n * \n * Calculates readiness scores for in-house marketing teams\n * considering their unique constraints and opportunities\n */\n\nexport class InhouseMarketingScoring {\n  constructor(config = {}) {\n    this.config = config;\n\n    // Dimension weights for overall score\n    this.dimensionWeights = {\n      humanReadiness: 0.4,\n      // Champions, leadership, resources\n      technicalReadiness: 0.3,\n      // Current capabilities\n      activityAutomation: 0.3 // Potential in their activities\n    };\n\n    // Category weights within dimensions\n    this.categoryWeights = {\n      champions: 0.35,\n      resources: 0.30,\n      leadership: 0.35,\n      readiness: 1.0 // Single category for technical\n    };\n\n    // Company size modifiers\n    this.sizeModifiers = {\n      solo: {\n        scoreBoost: 1.1,\n        // Solo marketers get boost for any progress\n        timeValue: 50,\n        // £/hour value\n        focusAreas: [\"efficiency\", \"quick_wins\"],\n        budgetRange: \"0-100\",\n        benchmarks: {\n          low: 25,\n          average: 40,\n          high: 65\n        }\n      },\n      small: {\n        scoreBoost: 1.0,\n        // No modifier\n        timeValue: 150,\n        // Team of 3 at £50/hour\n        focusAreas: [\"collaboration\", \"scalability\"],\n        budgetRange: \"100-500\",\n        benchmarks: {\n          low: 35,\n          average: 50,\n          high: 75\n        }\n      },\n      medium: {\n        scoreBoost: 0.9,\n        // Need higher capability for same score\n        timeValue: 400,\n        // Team of 8 at £50/hour\n        focusAreas: [\"transformation\", \"competitive_advantage\"],\n        budgetRange: \"500-2000\",\n        benchmarks: {\n          low: 45,\n          average: 60,\n          high: 85\n        }\n      }\n    };\n\n    // Activity impact scores (how much AI can help)\n    this.activityImpact = {\n      content_marketing: {\n        automationPotential: 85,\n        timesSavings: 70,\n        difficultyToImplement: 20,\n        quickWinPotential: 95\n      },\n      social_media: {\n        automationPotential: 75,\n        timesSavings: 60,\n        difficultyToImplement: 30,\n        quickWinPotential: 85\n      },\n      email_marketing: {\n        automationPotential: 70,\n        timesSavings: 50,\n        difficultyToImplement: 25,\n        quickWinPotential: 80\n      },\n      seo_sem: {\n        automationPotential: 65,\n        timesSavings: 40,\n        difficultyToImplement: 45,\n        quickWinPotential: 70\n      },\n      analytics_data: {\n        automationPotential: 90,\n        timesSavings: 85,\n        difficultyToImplement: 35,\n        quickWinPotential: 90\n      },\n      paid_advertising: {\n        automationPotential: 70,\n        timesSavings: 50,\n        difficultyToImplement: 40,\n        quickWinPotential: 75\n      },\n      creative_design: {\n        automationPotential: 60,\n        timesSavings: 40,\n        difficultyToImplement: 50,\n        quickWinPotential: 65\n      },\n      marketing_automation: {\n        automationPotential: 80,\n        timesSavings: 60,\n        difficultyToImplement: 55,\n        quickWinPotential: 70\n      }\n    };\n  }\n\n  /**\n   * Main scoring method\n   * @param {Object} answers - All question answers\n   * @param {Object} metadata - Company size, selected activities, etc.\n   * @returns {Object} Complete scoring results\n   */\n  calculateScores(answers, metadata) {\n    const {\n      companySize = 'small',\n      selectedActivities = [],\n      sector\n    } = metadata;\n\n    // Calculate category scores\n    const categoryScores = this.calculateCategoryScores(answers);\n\n    // Calculate dimension scores\n    const dimensionScores = this.calculateDimensionScores(categoryScores);\n\n    // Calculate activity-specific scores\n    const activityScores = this.calculateActivityScores(answers, selectedActivities);\n\n    // Calculate overall readiness\n    const overallScore = this.calculateOverallScore(dimensionScores, activityScores);\n\n    // Apply size modifiers\n    const adjustedScore = this.applySizeModifiers(overallScore, companySize);\n\n    // Calculate specific insights\n    const insights = this.generateInsights(categoryScores, activityScores, answers);\n\n    // Determine readiness level and recommendations\n    const readinessLevel = this.getReadinessLevel(adjustedScore, companySize);\n    const marketPosition = this.getMarketPosition(adjustedScore, companySize);\n\n    // Calculate time and cost savings potential\n    const savingsPotential = this.calculateSavingsPotential(activityScores, selectedActivities, companySize);\n\n    // Identify transformation priorities\n    const priorities = this.identifyPriorities(categoryScores, activityScores, selectedActivities, companySize);\n    return {\n      overall: Math.round(adjustedScore),\n      dimensions: {\n        humanReadiness: Math.round(dimensionScores.humanReadiness),\n        technicalReadiness: Math.round(dimensionScores.technicalReadiness),\n        activityAutomation: Math.round(dimensionScores.activityAutomation)\n      },\n      categoryScores: {\n        champions: Math.round(categoryScores.champions),\n        resources: Math.round(categoryScores.resources),\n        leadership: Math.round(categoryScores.leadership),\n        readiness: Math.round(categoryScores.readiness)\n      },\n      activityScores: activityScores,\n      readinessLevel: readinessLevel,\n      marketPosition: marketPosition,\n      savingsPotential: savingsPotential,\n      priorities: priorities,\n      insights: insights,\n      companySize: companySize,\n      selectedActivities: selectedActivities,\n      sector: sector,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Calculate category scores from raw answers\n   */\n  calculateCategoryScores(answers) {\n    const categories = {\n      champions: [],\n      resources: [],\n      leadership: [],\n      readiness: []\n    };\n\n    // Process each answer\n    Object.entries(answers).forEach(([questionId, answer]) => {\n      // Extract score value\n      const score = typeof answer === 'object' ? answer.score || answer.value || 0 : answer;\n\n      // Categorize based on question ID\n      if (questionId.includes('champion') || questionId.includes('knowledge') || questionId.includes('experimentation') || questionId.includes('tool_discovery') || questionId.includes('change_adoption')) {\n        categories.champions.push(score);\n      } else if (questionId.includes('time_availability') || questionId.includes('budget') || questionId.includes('current_pain') || questionId.includes('tech_complexity') || questionId.includes('capacity')) {\n        categories.resources.push(score);\n      } else if (questionId.includes('leadership') || questionId.includes('decision') || questionId.includes('success_metrics') || questionId.includes('transformation_ownership') || questionId.includes('risk_tolerance')) {\n        categories.leadership.push(score);\n      } else if (questionId.includes('current_ai_usage') || questionId.includes('data_quality')) {\n        categories.readiness.push(score);\n      }\n    });\n\n    // Calculate category averages\n    return {\n      champions: categories.champions.length > 0 ? categories.champions.reduce((sum, score) => sum + score, 0) / categories.champions.length * 25 : 50,\n      resources: categories.resources.length > 0 ? categories.resources.reduce((sum, score) => sum + score, 0) / categories.resources.length * 25 : 50,\n      leadership: categories.leadership.length > 0 ? categories.leadership.reduce((sum, score) => sum + score, 0) / categories.leadership.length * 25 : 50,\n      readiness: categories.readiness.length > 0 ? categories.readiness.reduce((sum, score) => sum + score, 0) / categories.readiness.length * 25 : 50\n    };\n  }\n\n  /**\n   * Calculate overall readiness score\n   */\n  calculateOverallScore(dimensionScores, activityScores) {\n    // Calculate average activity score\n    const activityValues = Object.values(activityScores);\n    const avgActivityScore = activityValues.length > 0 ? activityValues.reduce((sum, activity) => sum + activity.currentCapability, 0) / activityValues.length : 50;\n    dimensionScores.activityAutomation = avgActivityScore;\n\n    // Weighted combination\n    const overallScore = dimensionScores.humanReadiness * this.dimensionWeights.humanReadiness + dimensionScores.technicalReadiness * this.dimensionWeights.technicalReadiness + avgActivityScore * this.dimensionWeights.activityAutomation;\n    return overallScore;\n  }\n\n  /**\n   * Apply company size modifiers\n   */\n  applySizeModifiers(score, companySize) {\n    const modifier = this.sizeModifiers[companySize];\n    if (!modifier) return score;\n\n    // Apply boost/penalty based on company size\n    let adjustedScore = score * modifier.scoreBoost;\n\n    // Additional adjustments based on size-specific factors\n    if (companySize === 'solo' && score > 30) {\n      // Solo marketers get extra credit for any progress\n      adjustedScore += 5;\n    } else if (companySize === 'medium' && score < 50) {\n      // Medium teams need more capability for same readiness\n      adjustedScore -= 5;\n    }\n\n    // Keep within 0-100 bounds\n    return Math.max(0, Math.min(100, adjustedScore));\n  }\n\n  /**\n   * Get question weights for category\n   */\n  getQuestionWeights(category, answers) {\n    // Return weights based on question importance\n    // This could be expanded to use question metadata\n    const weights = {\n      champions: [1.5, 1.2, 1.3, 1.0, 1.1],\n      // Champion identification most important\n      resources: [1.3, 1.2, 1.1, 1.0, 1.2],\n      // Time availability most important\n      leadership: [1.5, 1.0, 1.2, 1.3, 1.1],\n      // Leadership attitude most important\n      readiness: [1.2, 1.1, 1.1, 1.2, 1.0] // Current AI usage most important\n    };\n    return weights[category];\n  }\n\n  /**\n   * Get readiness level based on score and company size\n   */\n  getReadinessLevel(score, companySize) {\n    const benchmarks = this.sizeModifiers[companySize].benchmarks;\n    if (score >= benchmarks.high) {\n      return {\n        level: 'high',\n        label: 'Transformation Ready',\n        description: 'Your team is ready to accelerate AI adoption',\n        color: '#00ff88'\n      };\n    } else if (score >= benchmarks.average) {\n      return {\n        level: 'medium',\n        label: 'Building Capability',\n        description: 'Good foundation with room for growth',\n        color: '#ffff66'\n      };\n    } else if (score >= benchmarks.low) {\n      return {\n        level: 'low',\n        label: 'Early Stage',\n        description: 'Starting the journey with quick wins',\n        color: '#ff8800'\n      };\n    } else {\n      return {\n        level: 'critical',\n        label: 'Urgent Action Needed',\n        description: 'Significant gap to close quickly',\n        color: '#ff4444'\n      };\n    }\n  }\n\n  /**\n   * Get market position\n   */\n  getMarketPosition(score, companySize) {\n    const benchmarks = this.sizeModifiers[companySize].benchmarks;\n    let percentile;\n    if (score >= benchmarks.high) {\n      percentile = 75 + (score - benchmarks.high) / (100 - benchmarks.high) * 25;\n    } else if (score >= benchmarks.average) {\n      percentile = 50 + (score - benchmarks.average) / (benchmarks.high - benchmarks.average) * 25;\n    } else if (score >= benchmarks.low) {\n      percentile = 25 + (score - benchmarks.low) / (benchmarks.average - benchmarks.low) * 25;\n    } else {\n      percentile = score / benchmarks.low * 25;\n    }\n    return {\n      percentile: Math.round(percentile),\n      comparison: `You're ahead of ${Math.round(percentile)}% of similar ${companySize} marketing teams`,\n      trend: percentile > 50 ? 'leading' : 'lagging',\n      implication: this.getMarketImplication(percentile)\n    };\n  }\n\n  /**\n   * Calculate savings potential\n   */\n  calculateSavingsPotential(activityScores, selectedActivities, companySize) {\n    const sizeData = this.sizeModifiers[companySize];\n    const hoursPerWeek = companySize === 'solo' ? 50 : companySize === 'small' ? 120 : 320;\n    let totalTimeSavings = 0;\n    let totalHoursSaved = 0;\n    selectedActivities.forEach(activity => {\n      const score = activityScores[activity];\n      if (score) {\n        const potentialSavings = score.timesSavingsPotential / 100;\n        const currentEfficiency = score.currentCapability / 100;\n        const additionalSavings = potentialSavings - currentEfficiency * potentialSavings;\n\n        // Estimate hours spent on this activity (rough approximation)\n        const activityHours = hoursPerWeek * 0.15; // Assume 15% time per activity;\n        const hoursSaved = activityHours * additionalSavings;\n        totalHoursSaved += hoursSaved;\n        totalTimeSavings += additionalSavings;\n      }\n    });\n    const avgTimeSavings = selectedActivities.length > 0 ? totalTimeSavings / selectedActivities.length : 0;\n    return {\n      weeklyHoursSaved: Math.round(totalHoursSaved),\n      monthlyHoursSaved: Math.round(totalHoursSaved * 4),\n      percentageTimeSaved: Math.round(avgTimeSavings * 100),\n      monetaryValue: Math.round(totalHoursSaved * 4 * sizeData.timeValue),\n      timeToROI: this.calculateTimeToROI(sizeData.budgetRange, totalHoursSaved * 4 * sizeData.timeValue)\n    };\n  }\n\n  /**\n   * Identify transformation priorities\n   */\n  identifyPriorities(categoryScores, activityScores, selectedActivities, companySize) {\n    const priorities = [];\n\n    // Human readiness priorities\n    if (categoryScores.champions < 40) {\n      priorities.push({\n        type: 'human',\n        area: 'champions',\n        urgency: 'high',\n        action: 'Identify and empower AI champions in your team',\n        impact: 'Accelerates adoption by 3x'\n      });\n    }\n    if (categoryScores.leadership < 40) {\n      priorities.push({\n        type: 'human',\n        area: 'leadership',\n        urgency: 'high',\n        action: 'Get leadership hands-on with AI tools',\n        impact: 'Unlocks resources and removes barriers'\n      });\n    }\n\n    // Activity priorities\n    Object.entries(activityScores).forEach(([activity, score]) => {\n      if (score.priority === 'high' && score.opportunityGap > 50) {\n        priorities.push({\n          type: 'activity',\n          area: activity,\n          urgency: 'high',\n          action: `Transform ${this.formatActivityName(activity)} with AI`,\n          impact: `Save ${score.timesSavingsPotential}% of time spent`\n        });\n      }\n    });\n\n    // Technical priorities\n    if (categoryScores.readiness < 30) {\n      priorities.push({\n        type: 'technical',\n        area: 'foundation',\n        urgency: 'critical',\n        action: 'Start with basic AI tool experimentation',\n        impact: 'Build foundation for all other improvements'\n      });\n    }\n\n    // Size-specific priorities\n    const sizeData = this.sizeModifiers[companySize];\n    sizeData.focusAreas.forEach(focus => {\n      if (focus === 'efficiency' && priorities.filter(p => p.type === 'activity').length === 0) {\n        priorities.push({\n          type: 'strategic',\n          area: focus,\n          urgency: 'medium',\n          action: 'Focus on time-saving quick wins',\n          impact: 'Immediate productivity gains'\n        });\n      }\n    });\n\n    // Sort by urgency and limit to top 5\n    return priorities.sort((a, b) => {\n      const urgencyOrder = {\n        critical: 0,\n        high: 1,\n        medium: 2,\n        low: 3\n      };\n      return urgencyOrder[a.urgency] - urgencyOrder[b.urgency];\n    }).slice(0, 5);\n  }\n\n  /**\n   * Generate specific insights\n   */\n  generateInsights(categoryScores, activityScores, answers) {\n    var _answers$time_availab;\n    const insights = [];\n\n    // Champion insights\n    if (categoryScores.champions > 70) {\n      insights.push({\n        type: 'strength',\n        message: 'Your team shows exceptional openness to AI - a critical success factor',\n        category: 'human'\n      });\n    } else if (categoryScores.champions < 30) {\n      insights.push({\n        type: 'gap',\n        message: 'Limited AI enthusiasm could slow adoption - identify champions urgently',\n        category: 'human'\n      });\n    }\n\n    // Resource insights\n    if (categoryScores.resources < 40 && categoryScores.champions > 60) {\n      insights.push({\n        type: 'opportunity',\n        message: 'Team is ready but lacks resources - perfect case for AI efficiency gains',\n        category: 'strategic'\n      });\n    }\n\n    // Activity insights\n    const highOpportunityActivities = Object.entries(activityScores).filter(([_, score]) => score.opportunityGap > 60).map(([activity]) => activity);\n    if (highOpportunityActivities.length > 0) {\n      insights.push({\n        type: 'opportunity',\n        message: `Major untapped potential in ${this.formatActivityName(highOpportunityActivities[0])}`,\n        category: 'activity'\n      });\n    }\n\n    // Time pressure insight\n    const timePressure = ((_answers$time_availab = answers.time_availability) === null || _answers$time_availab === void 0 ? void 0 : _answers$time_availab.score) || answers.time_availability;\n    if (timePressure <= 2) {\n      insights.push({\n        type: 'critical',\n        message: 'Severe time constraints make AI automation essential, not optional',\n        category: 'business'\n      });\n    }\n    return insights;\n  }\n\n  // Helper methods\n  getActivityReadinessLevel(score) {\n    if (score >= 70) return 'high';\n    if (score >= 40) return 'medium';\n    return 'low';\n  }\n  calculateActivityPriority(currentCapability, impact) {\n    const gap = impact.automationPotential - currentCapability;\n    const ease = 100 - impact.difficultyToImplement;\n    const value = impact.timesSavings;\n    const priorityScore = gap * 0.4 + ease * 0.3 + value * 0.3;\n    if (priorityScore > 70) return 'high';\n    if (priorityScore > 40) return 'medium';\n    return 'low';\n  }\n  formatActivityName(activity) {\n    const names = {\n      content_marketing: 'Content Marketing',\n      social_media: 'Social Media',\n      email_marketing: 'Email Marketing',\n      seo_sem: 'SEO & SEM',\n      analytics_data: 'Analytics & Reporting',\n      paid_advertising: 'Paid Advertising',\n      creative_design: 'Creative & Design',\n      marketing_automation: 'Marketing Automation'\n    };\n    return names[activity] || activity;\n  }\n  getMarketImplication(percentile) {\n    if (percentile >= 75) return 'Position of strength - extend your lead';\n    if (percentile >= 50) return 'Above average - opportunity to leap ahead';\n    if (percentile >= 25) return 'Below average - urgent improvement needed';\n    return 'Critical gap - immediate action required';\n  }\n  calculateTimeToROI(budgetRange, monthlySavings) {\n    const avgBudget = budgetRange === '0-100' ? 50 : budgetRange === '100-500' ? 300 : budgetRange === '500-2000' ? 1000 : 500;\n    const months = avgBudget / monthlySavings;\n    if (months < 1) return 'Immediate ROI';\n    if (months < 3) return `${Math.ceil(months)} months`;\n    if (months < 6) return '3-6 months';\n    return '6+ months';\n  }\n\n  /**\n   * Calculate dimension scores from category scores\n   */\n  calculateDimensionScores(categoryScores) {\n    // Calculate human readiness dimension (champions, leadership, resources)\n    const humanReadiness = (categoryScores.champions * this.categoryWeights.champions + categoryScores.leadership * this.categoryWeights.leadership + categoryScores.resources * this.categoryWeights.resources) / (this.categoryWeights.champions + this.categoryWeights.leadership + this.categoryWeights.resources);\n\n    // Technical readiness is the same as the readiness category score\n    const technicalReadiness = categoryScores.readiness * this.categoryWeights.readiness;\n\n    // Activity automation is calculated separately\n\n    // Return the dimension scores\n    return {\n      humanReadiness: Math.round(humanReadiness),\n      technicalReadiness: Math.round(technicalReadiness),\n      activityAutomation: 50,\n      // Placeholder, calculated separately\n      overallScore: Math.round(overallScore) // Add this for consistency\n    };\n  }\n\n  /**\n   * Calculate activity-specific scores\n   */\n  calculateActivityScores(answers, selectedActivities) {\n    var _answers$technical_re, _answers$tool_availab, _answers$data_quality;\n    const activityScores = {};\n\n    // Default base scores from technical capabilities\n    const baseReadiness = ((_answers$technical_re = answers.technical_readiness) === null || _answers$technical_re === void 0 ? void 0 : _answers$technical_re.score) || answers.technical_readiness || 3;\n    const toolAvailability = ((_answers$tool_availab = answers.tool_availability) === null || _answers$tool_availab === void 0 ? void 0 : _answers$tool_availab.score) || answers.tool_availability || 3;\n    const dataQuality = ((_answers$data_quality = answers.data_quality) === null || _answers$data_quality === void 0 ? void 0 : _answers$data_quality.score) || answers.data_quality || 3;\n\n    // Process each selected activity\n    selectedActivities.forEach(activity => {\n      var _answers;\n      // Get impact potential for this activity\n      const impact = this.activityImpact[activity] || {\n        automationPotential: 50,\n        timesSavings: 40,\n        difficultyToImplement: 50,\n        quickWinPotential: 50\n      };\n\n      // Calculate current capability\n      const activityReadiness = ((_answers = answers[`${activity}_capability`]) === null || _answers === void 0 ? void 0 : _answers.score) || answers[`${activity}_capability`] || baseReadiness;\n\n      // Scale score to 0-100\n      const currentScore = activityReadiness / 5 * 100;\n\n      // Calculate gap between current capability and potential\n      const opportunityGap = impact.automationPotential - currentScore;\n\n      // Calculate ROI potential based on time savings and implementation difficulty\n      const roiPotential = impact.timesSavings * (100 - impact.difficultyToImplement) / 100;\n\n      // Calculate priority level\n      const priority = this.calculateActivityPriority(currentScore, impact);\n\n      // Store all scores for this activity\n      activityScores[activity] = {\n        currentScore: Math.round(currentScore),\n        currentCapability: Math.round(currentScore),\n        // Add this for consistency\n        automationPotential: impact.automationPotential,\n        opportunityGap: Math.round(opportunityGap),\n        timeSavings: impact.timesSavings,\n        implementationEffort: impact.difficultyToImplement,\n        quickWinPotential: impact.quickWinPotential,\n        roiPotential: Math.round(roiPotential),\n        priority: priority,\n        readinessLevel: this.getActivityReadinessLevel(currentScore)\n      };\n    });\n\n    // Return the activity scores\n    return activityScores;\n  }\n\n  /**\n   * Calculate overall score from dimension scores and activity scores\n   */\n  calculateOverallScore(dimensionScores, activityScores) {\n    // The dimensionScores object already contains an overall score based on dimensions\n    let overallScore = dimensionScores.overallScore;\n\n    // If we have activity scores, factor them into the overall calculation\n    if (activityScores && Object.keys(activityScores).length > 0) {\n      // Calculate average activity score\n      const activityValues = Object.values(activityScores);\n      const avgActivityScore = activityValues.reduce((sum, activity) => {\n        return sum + activity.currentCapability; // Note: using currentCapability not currentScore\n      }, 0) / activityValues.length;\n\n      // Blend the activity score with the dimension-based score\n      // We give slightly more weight to the dimension scores as they're more comprehensive\n      overallScore = Math.round(overallScore * 0.6 + avgActivityScore * 0.4);\n    }\n    return overallScore;\n  }\n}\n\n// Export for use in assessment system\nexport default InhouseMarketingScoring;","map":{"version":3,"names":["InhouseMarketingScoring","constructor","config","dimensionWeights","humanReadiness","technicalReadiness","activityAutomation","categoryWeights","champions","resources","leadership","readiness","sizeModifiers","solo","scoreBoost","timeValue","focusAreas","budgetRange","benchmarks","low","average","high","small","medium","activityImpact","content_marketing","automationPotential","timesSavings","difficultyToImplement","quickWinPotential","social_media","email_marketing","seo_sem","analytics_data","paid_advertising","creative_design","marketing_automation","calculateScores","answers","metadata","companySize","selectedActivities","sector","categoryScores","calculateCategoryScores","dimensionScores","calculateDimensionScores","activityScores","calculateActivityScores","overallScore","calculateOverallScore","adjustedScore","applySizeModifiers","insights","generateInsights","readinessLevel","getReadinessLevel","marketPosition","getMarketPosition","savingsPotential","calculateSavingsPotential","priorities","identifyPriorities","overall","Math","round","dimensions","timestamp","Date","toISOString","categories","Object","entries","forEach","questionId","answer","score","value","includes","push","length","reduce","sum","activityValues","values","avgActivityScore","activity","currentCapability","modifier","max","min","getQuestionWeights","category","weights","level","label","description","color","percentile","comparison","trend","implication","getMarketImplication","sizeData","hoursPerWeek","totalTimeSavings","totalHoursSaved","potentialSavings","timesSavingsPotential","currentEfficiency","additionalSavings","activityHours","hoursSaved","avgTimeSavings","weeklyHoursSaved","monthlyHoursSaved","percentageTimeSaved","monetaryValue","timeToROI","calculateTimeToROI","type","area","urgency","action","impact","priority","opportunityGap","formatActivityName","focus","filter","p","sort","a","b","urgencyOrder","critical","slice","_answers$time_availab","message","highOpportunityActivities","_","map","timePressure","time_availability","getActivityReadinessLevel","calculateActivityPriority","gap","ease","priorityScore","names","monthlySavings","avgBudget","months","ceil","_answers$technical_re","_answers$tool_availab","_answers$data_quality","baseReadiness","technical_readiness","toolAvailability","tool_availability","dataQuality","data_quality","_answers","activityReadiness","currentScore","roiPotential","timeSavings","implementationEffort","keys"],"sources":["/Users/jon/Documents/GitHub/assessor/src/assessments/inhouse-marketing/scoring.js"],"sourcesContent":["/**\n * In-House Marketing Scoring Engine\n * \n * Calculates readiness scores for in-house marketing teams\n * considering their unique constraints and opportunities\n */\n\nexport class InhouseMarketingScoring {\n    constructor(config = {}) {\n      this.config = config;\n      \n      // Dimension weights for overall score\n      this.dimensionWeights = {\n        humanReadiness: 0.4,      // Champions, leadership, resources\n        technicalReadiness: 0.3,   // Current capabilities\n        activityAutomation: 0.3    // Potential in their activities\n      };\n      \n      // Category weights within dimensions\n      this.categoryWeights = {\n        champions: 0.35,\n        resources: 0.30,\n        leadership: 0.35,\n        readiness: 1.0  // Single category for technical\n      };\n      \n      // Company size modifiers\n      this.sizeModifiers = {\n        solo: {\n          scoreBoost: 1.1,        // Solo marketers get boost for any progress\n          timeValue: 50,          // £/hour value\n          focusAreas: [\"efficiency\", \"quick_wins\"],\n          budgetRange: \"0-100\",\n          benchmarks: {\n            low: 25,\n            average: 40,\n            high: 65\n          }\n        },\n        small: {\n          scoreBoost: 1.0,        // No modifier\n          timeValue: 150,         // Team of 3 at £50/hour\n          focusAreas: [\"collaboration\", \"scalability\"],\n          budgetRange: \"100-500\",\n          benchmarks: {\n            low: 35,\n            average: 50,\n            high: 75\n          }\n        },\n        medium: {\n          scoreBoost: 0.9,        // Need higher capability for same score\n          timeValue: 400,         // Team of 8 at £50/hour\n          focusAreas: [\"transformation\", \"competitive_advantage\"],\n          budgetRange: \"500-2000\",\n          benchmarks: {\n            low: 45,\n            average: 60,\n            high: 85\n          }\n        }\n      };\n      \n      // Activity impact scores (how much AI can help)\n      this.activityImpact = {\n        content_marketing: {\n          automationPotential: 85,\n          timesSavings: 70,\n          difficultyToImplement: 20,\n          quickWinPotential: 95\n        },\n        social_media: {\n          automationPotential: 75,\n          timesSavings: 60,\n          difficultyToImplement: 30,\n          quickWinPotential: 85\n        },\n        email_marketing: {\n          automationPotential: 70,\n          timesSavings: 50,\n          difficultyToImplement: 25,\n          quickWinPotential: 80\n        },\n        seo_sem: {\n          automationPotential: 65,\n          timesSavings: 40,\n          difficultyToImplement: 45,\n          quickWinPotential: 70\n        },\n        analytics_data: {\n          automationPotential: 90,\n          timesSavings: 85,\n          difficultyToImplement: 35,\n          quickWinPotential: 90\n        },\n        paid_advertising: {\n          automationPotential: 70,\n          timesSavings: 50,\n          difficultyToImplement: 40,\n          quickWinPotential: 75\n        },\n        creative_design: {\n          automationPotential: 60,\n          timesSavings: 40,\n          difficultyToImplement: 50,\n          quickWinPotential: 65\n        },\n        marketing_automation: {\n          automationPotential: 80,\n          timesSavings: 60,\n          difficultyToImplement: 55,\n          quickWinPotential: 70\n        }\n      }\n    }\n  \n    /**\n     * Main scoring method\n     * @param {Object} answers - All question answers\n     * @param {Object} metadata - Company size, selected activities, etc.\n     * @returns {Object} Complete scoring results\n     */\n    calculateScores(answers, metadata) {\n      const { companySize = 'small', selectedActivities = [], sector } = metadata;\n      \n      // Calculate category scores\n      const categoryScores = this.calculateCategoryScores(answers);\n      \n      // Calculate dimension scores\n      const dimensionScores = this.calculateDimensionScores(categoryScores);\n      \n      // Calculate activity-specific scores\n      const activityScores = this.calculateActivityScores(answers, selectedActivities);\n      \n      // Calculate overall readiness\n      const overallScore = this.calculateOverallScore(dimensionScores, activityScores);\n      \n      // Apply size modifiers\n      const adjustedScore = this.applySizeModifiers(overallScore, companySize);\n      \n      // Calculate specific insights\n      const insights = this.generateInsights(categoryScores, activityScores, answers);\n      \n      // Determine readiness level and recommendations\n      const readinessLevel = this.getReadinessLevel(adjustedScore, companySize);\n      const marketPosition = this.getMarketPosition(adjustedScore, companySize);\n      \n      // Calculate time and cost savings potential\n      const savingsPotential = this.calculateSavingsPotential(\n        activityScores, \n        selectedActivities, \n        companySize\n      );\n      \n      // Identify transformation priorities\n      const priorities = this.identifyPriorities(\n        categoryScores, \n        activityScores, \n        selectedActivities,\n        companySize\n      );\n      \n      return {\n        overall: Math.round(adjustedScore),\n        dimensions: {\n          humanReadiness: Math.round(dimensionScores.humanReadiness),\n          technicalReadiness: Math.round(dimensionScores.technicalReadiness),\n          activityAutomation: Math.round(dimensionScores.activityAutomation)\n        },\n        categoryScores: {\n          champions: Math.round(categoryScores.champions),\n          resources: Math.round(categoryScores.resources),\n          leadership: Math.round(categoryScores.leadership),\n          readiness: Math.round(categoryScores.readiness)\n        },\n        activityScores: activityScores,\n        readinessLevel: readinessLevel,\n        marketPosition: marketPosition,\n        savingsPotential: savingsPotential,\n        priorities: priorities,\n        insights: insights,\n        companySize: companySize,\n        selectedActivities: selectedActivities,\n        sector: sector,\n        timestamp: new Date().toISOString()\n      }\n    }\n  \n    /**\n     * Calculate category scores from raw answers\n     */\n    calculateCategoryScores(answers) {\n      const categories = {\n        champions: [],\n        resources: [],\n        leadership: [],\n        readiness: []\n      };\n      \n      // Process each answer\n      Object.entries(answers).forEach(([questionId, answer]) => {\n        // Extract score value\n        const score = typeof answer === 'object' ? (answer.score || answer.value || 0) : answer;\n        \n        // Categorize based on question ID\n        if (questionId.includes('champion') || questionId.includes('knowledge') || \n            questionId.includes('experimentation') || questionId.includes('tool_discovery') || \n            questionId.includes('change_adoption')) {\n          categories.champions.push(score)\n        } else if (questionId.includes('time_availability') || questionId.includes('budget') || \n                   questionId.includes('current_pain') || questionId.includes('tech_complexity') || \n                   questionId.includes('capacity')) {\n          categories.resources.push(score)\n        } else if (questionId.includes('leadership') || questionId.includes('decision') || \n                   questionId.includes('success_metrics') || questionId.includes('transformation_ownership') || \n                   questionId.includes('risk_tolerance')) {\n          categories.leadership.push(score)\n        } else if (questionId.includes('current_ai_usage') || questionId.includes('data_quality')) {\n          categories.readiness.push(score)\n        }\n      });\n      \n      // Calculate category averages\n      return {\n        champions: categories.champions.length > 0 ? categories.champions.reduce((sum, score) => sum + score, 0) / categories.champions.length * 25 : 50,\n        resources: categories.resources.length > 0 ? categories.resources.reduce((sum, score) => sum + score, 0) / categories.resources.length * 25 : 50,\n        leadership: categories.leadership.length > 0 ? categories.leadership.reduce((sum, score) => sum + score, 0) / categories.leadership.length * 25 : 50,\n        readiness: categories.readiness.length > 0 ? categories.readiness.reduce((sum, score) => sum + score, 0) / categories.readiness.length * 25 : 50\n      };\n    }\n  \n    /**\n     * Calculate overall readiness score\n     */\n    calculateOverallScore(dimensionScores, activityScores) {\n      // Calculate average activity score\n      const activityValues = Object.values(activityScores);\n      const avgActivityScore = activityValues.length > 0\n        ? activityValues.reduce((sum, activity) => sum + activity.currentCapability, 0) / activityValues.length\n        : 50;\n      \n      dimensionScores.activityAutomation = avgActivityScore;\n      \n      // Weighted combination\n      const overallScore = \n        dimensionScores.humanReadiness * this.dimensionWeights.humanReadiness +\n        dimensionScores.technicalReadiness * this.dimensionWeights.technicalReadiness +\n        avgActivityScore * this.dimensionWeights.activityAutomation;\n      \n      return overallScore;\n    }\n  \n    /**\n     * Apply company size modifiers\n     */\n    applySizeModifiers(score, companySize) {\n      const modifier = this.sizeModifiers[companySize];\n      if (!modifier) return score;\n      \n      // Apply boost/penalty based on company size\n      let adjustedScore = score * modifier.scoreBoost;\n      \n      // Additional adjustments based on size-specific factors\n      if (companySize === 'solo' && score > 30) {\n        // Solo marketers get extra credit for any progress\n        adjustedScore += 5\n      } else if (companySize === 'medium' && score < 50) {\n        // Medium teams need more capability for same readiness\n        adjustedScore -= 5\n      }\n      \n      // Keep within 0-100 bounds\n      return Math.max(0, Math.min(100, adjustedScore));\n    }\n  \n    /**\n     * Get question weights for category\n     */\n    getQuestionWeights(category, answers) {\n      // Return weights based on question importance\n      // This could be expanded to use question metadata\n      const weights = {\n        champions: [1.5, 1.2, 1.3, 1.0, 1.1], // Champion identification most important\n        resources: [1.3, 1.2, 1.1, 1.0, 1.2],  // Time availability most important\n        leadership: [1.5, 1.0, 1.2, 1.3, 1.1], // Leadership attitude most important\n        readiness: [1.2, 1.1, 1.1, 1.2, 1.0]   // Current AI usage most important\n      };\n      \n      return weights[category];\n    }\n  \n    /**\n     * Get readiness level based on score and company size\n     */\n    getReadinessLevel(score, companySize) {\n      const benchmarks = this.sizeModifiers[companySize].benchmarks;\n      \n      if (score >= benchmarks.high) {\n        return {\n          level: 'high',\n          label: 'Transformation Ready',\n          description: 'Your team is ready to accelerate AI adoption',\n          color: '#00ff88'\n        }\n      } else if (score >= benchmarks.average) {\n        return {\n          level: 'medium',\n          label: 'Building Capability',\n          description: 'Good foundation with room for growth',\n          color: '#ffff66'\n        }\n      } else if (score >= benchmarks.low) {\n        return {\n          level: 'low',\n          label: 'Early Stage',\n          description: 'Starting the journey with quick wins',\n          color: '#ff8800'\n        }\n      } else {\n        return {\n          level: 'critical',\n          label: 'Urgent Action Needed',\n          description: 'Significant gap to close quickly',\n          color: '#ff4444'\n        }\n      }\n    }\n  \n    /**\n     * Get market position\n     */\n    getMarketPosition(score, companySize) {\n      const benchmarks = this.sizeModifiers[companySize].benchmarks;\n      \n      let percentile;\n      if (score >= benchmarks.high) {\n        percentile = 75 + (score - benchmarks.high) / (100 - benchmarks.high) * 25\n      } else if (score >= benchmarks.average) {\n        percentile = 50 + (score - benchmarks.average) / (benchmarks.high - benchmarks.average) * 25\n      } else if (score >= benchmarks.low) {\n        percentile = 25 + (score - benchmarks.low) / (benchmarks.average - benchmarks.low) * 25\n      } else {\n        percentile = score / benchmarks.low * 25\n      }\n      \n      return {\n        percentile: Math.round(percentile),\n        comparison: `You're ahead of ${Math.round(percentile)}% of similar ${companySize} marketing teams`,\n        trend: percentile > 50 ? 'leading' : 'lagging',\n        implication: this.getMarketImplication(percentile)\n      }\n    }\n  \n    /**\n     * Calculate savings potential\n     */\n    calculateSavingsPotential(activityScores, selectedActivities, companySize) {\n      const sizeData = this.sizeModifiers[companySize];\n      const hoursPerWeek = companySize === 'solo' ? 50 : companySize === 'small' ? 120 : 320;\n      \n      let totalTimeSavings = 0;\n      let totalHoursSaved = 0;\n      \n      selectedActivities.forEach(activity => {\n        const score = activityScores[activity];\n        if (score) {\n          const potentialSavings = score.timesSavingsPotential / 100;\n          const currentEfficiency = score.currentCapability / 100;\n          const additionalSavings = potentialSavings - (currentEfficiency * potentialSavings);\n          \n          // Estimate hours spent on this activity (rough approximation)\n          const activityHours = hoursPerWeek * 0.15; // Assume 15% time per activity;\n          const hoursSaved = activityHours * additionalSavings;\n          \n          totalHoursSaved += hoursSaved;\n          totalTimeSavings += additionalSavings\n        }\n      });\n      \n      const avgTimeSavings = selectedActivities.length > 0\n        ? totalTimeSavings / selectedActivities.length \n        : 0;\n      \n      return {\n        weeklyHoursSaved: Math.round(totalHoursSaved),\n        monthlyHoursSaved: Math.round(totalHoursSaved * 4),\n        percentageTimeSaved: Math.round(avgTimeSavings * 100),\n        monetaryValue: Math.round(totalHoursSaved * 4 * sizeData.timeValue),\n        timeToROI: this.calculateTimeToROI(sizeData.budgetRange, totalHoursSaved * 4 * sizeData.timeValue)\n      }\n    }\n  \n    /**\n     * Identify transformation priorities\n     */\n    identifyPriorities(categoryScores, activityScores, selectedActivities, companySize) {\n      const priorities = [];\n      \n      // Human readiness priorities\n      if (categoryScores.champions < 40) {\n        priorities.push({\n          type: 'human',\n          area: 'champions',\n          urgency: 'high',\n          action: 'Identify and empower AI champions in your team',\n          impact: 'Accelerates adoption by 3x'\n        })\n      }\n      \n      if (categoryScores.leadership < 40) {\n        priorities.push({\n          type: 'human',\n          area: 'leadership',\n          urgency: 'high',\n          action: 'Get leadership hands-on with AI tools',\n          impact: 'Unlocks resources and removes barriers'\n        })\n      }\n      \n      // Activity priorities\n      Object.entries(activityScores).forEach(([activity, score]) => {\n        if (score.priority === 'high' && score.opportunityGap > 50) {\n          priorities.push({\n            type: 'activity',\n            area: activity,\n            urgency: 'high',\n            action: `Transform ${this.formatActivityName(activity)} with AI`,\n            impact: `Save ${score.timesSavingsPotential}% of time spent`\n          })\n        }\n      });\n      \n      // Technical priorities\n      if (categoryScores.readiness < 30) {\n        priorities.push({\n          type: 'technical',\n          area: 'foundation',\n          urgency: 'critical',\n          action: 'Start with basic AI tool experimentation',\n          impact: 'Build foundation for all other improvements'\n        })\n      }\n      \n      // Size-specific priorities\n      const sizeData = this.sizeModifiers[companySize];\n      sizeData.focusAreas.forEach(focus => {\n        if (focus === 'efficiency' && priorities.filter(p => p.type === 'activity').length === 0) {\n          priorities.push({\n            type: 'strategic',\n            area: focus,\n            urgency: 'medium',\n            action: 'Focus on time-saving quick wins',\n            impact: 'Immediate productivity gains'\n          })\n        }\n      });\n      \n      // Sort by urgency and limit to top 5\n      return priorities\n        .sort((a, b) => {\n          const urgencyOrder = { critical: 0, high: 1, medium: 2, low: 3 };\n          return urgencyOrder[a.urgency] - urgencyOrder[b.urgency];\n        })\n        .slice(0, 5)\n    }\n  \n    /**\n     * Generate specific insights\n     */\n    generateInsights(categoryScores, activityScores, answers) {\n      const insights = [];\n      \n      // Champion insights\n      if (categoryScores.champions > 70) {\n        insights.push({\n          type: 'strength',\n          message: 'Your team shows exceptional openness to AI - a critical success factor',\n          category: 'human'\n        })\n      } else if (categoryScores.champions < 30) {\n        insights.push({\n          type: 'gap',\n          message: 'Limited AI enthusiasm could slow adoption - identify champions urgently',\n          category: 'human'\n        })\n      }\n      \n      // Resource insights\n      if (categoryScores.resources < 40 && categoryScores.champions > 60) {\n        insights.push({\n          type: 'opportunity',\n          message: 'Team is ready but lacks resources - perfect case for AI efficiency gains',\n          category: 'strategic'\n        })\n      }\n      \n      // Activity insights\n      const highOpportunityActivities = Object.entries(activityScores)\n        .filter(([_, score]) => score.opportunityGap > 60)\n        .map(([activity]) => activity);\n      \n      if (highOpportunityActivities.length > 0) {\n        insights.push({\n          type: 'opportunity',\n          message: `Major untapped potential in ${this.formatActivityName(highOpportunityActivities[0])}`,\n          category: 'activity'\n        })\n      }\n      \n      // Time pressure insight\n      const timePressure = answers.time_availability?.score || answers.time_availability;\n      if (timePressure <= 2) {\n        insights.push({\n          type: 'critical',\n          message: 'Severe time constraints make AI automation essential, not optional',\n          category: 'business'\n        })\n      }\n      \n      return insights;\n    }\n  \n    // Helper methods\n    getActivityReadinessLevel(score) {\n      if (score >= 70) return 'high';\n      if (score >= 40) return 'medium';\n      return 'low';\n    }\n    ;\n    calculateActivityPriority(currentCapability, impact) {\n      const gap = impact.automationPotential - currentCapability;\n      const ease = 100 - impact.difficultyToImplement;\n      const value = impact.timesSavings;\n      \n      const priorityScore = (gap * 0.4) + (ease * 0.3) + (value * 0.3);\n      \n      if (priorityScore > 70) return 'high';\n      if (priorityScore > 40) return 'medium';\n      return 'low';\n    }\n    ;\n    formatActivityName(activity) {\n      const names = {\n        content_marketing: 'Content Marketing',\n        social_media: 'Social Media',\n        email_marketing: 'Email Marketing',\n        seo_sem: 'SEO & SEM',\n        analytics_data: 'Analytics & Reporting',\n        paid_advertising: 'Paid Advertising',\n        creative_design: 'Creative & Design',\n        marketing_automation: 'Marketing Automation'\n      };\n      return names[activity] || activity;\n    }\n    ;\n    getMarketImplication(percentile) {\n      if (percentile >= 75) return 'Position of strength - extend your lead';\n      if (percentile >= 50) return 'Above average - opportunity to leap ahead';\n      if (percentile >= 25) return 'Below average - urgent improvement needed';\n      return 'Critical gap - immediate action required';\n    }\n    ;\n    calculateTimeToROI(budgetRange, monthlySavings) {\n      const avgBudget = budgetRange === '0-100' ? 50 :\n                        budgetRange === '100-500' ? 300 : \n                        budgetRange === '500-2000' ? 1000 : 500;\n      \n      const months = avgBudget / monthlySavings;\n      \n      if (months < 1) return 'Immediate ROI';\n      if (months < 3) return `${Math.ceil(months)} months`;\n      if (months < 6) return '3-6 months';\n      return '6+ months';\n    }\n    \n    /**\n     * Calculate dimension scores from category scores\n     */\n    calculateDimensionScores(categoryScores) {\n      // Calculate human readiness dimension (champions, leadership, resources)\n      const humanReadiness = (\n        (categoryScores.champions * this.categoryWeights.champions) +\n        (categoryScores.leadership * this.categoryWeights.leadership) +\n        (categoryScores.resources * this.categoryWeights.resources)\n      ) / (this.categoryWeights.champions + this.categoryWeights.leadership + this.categoryWeights.resources);\n      \n      // Technical readiness is the same as the readiness category score\n      const technicalReadiness = categoryScores.readiness * this.categoryWeights.readiness;\n      \n      // Activity automation is calculated separately\n      \n      // Return the dimension scores\n      return {\n        humanReadiness: Math.round(humanReadiness),\n        technicalReadiness: Math.round(technicalReadiness),\n        activityAutomation: 50, // Placeholder, calculated separately\n        overallScore: Math.round(overallScore) // Add this for consistency\n      }\n    }\n    \n    /**\n     * Calculate activity-specific scores\n     */\n    calculateActivityScores(answers, selectedActivities) {\n      const activityScores = {};\n      \n      // Default base scores from technical capabilities\n      const baseReadiness = answers.technical_readiness?.score || answers.technical_readiness || 3;\n      const toolAvailability = answers.tool_availability?.score || answers.tool_availability || 3;\n      const dataQuality = answers.data_quality?.score || answers.data_quality || 3;\n      \n      // Process each selected activity\n      selectedActivities.forEach(activity => {\n        // Get impact potential for this activity\n        const impact = this.activityImpact[activity] || {\n          automationPotential: 50,\n          timesSavings: 40,\n          difficultyToImplement: 50,\n          quickWinPotential: 50\n        };\n        \n        // Calculate current capability\n        const activityReadiness = answers[`${activity}_capability`]?.score || \n                                answers[`${activity}_capability`] || \n                                baseReadiness;\n        \n        // Scale score to 0-100\n        const currentScore = (activityReadiness / 5) * 100;\n        \n        // Calculate gap between current capability and potential\n        const opportunityGap = impact.automationPotential - currentScore;\n        \n        // Calculate ROI potential based on time savings and implementation difficulty\n        const roiPotential = impact.timesSavings * (100 - impact.difficultyToImplement) / 100;\n        \n        // Calculate priority level\n        const priority = this.calculateActivityPriority(currentScore, impact);\n        \n        // Store all scores for this activity\n        activityScores[activity] = {\n          currentScore: Math.round(currentScore),\n          currentCapability: Math.round(currentScore), // Add this for consistency\n          automationPotential: impact.automationPotential,\n          opportunityGap: Math.round(opportunityGap),\n          timeSavings: impact.timesSavings,\n          implementationEffort: impact.difficultyToImplement,\n          quickWinPotential: impact.quickWinPotential,\n          roiPotential: Math.round(roiPotential),\n          priority: priority,\n          readinessLevel: this.getActivityReadinessLevel(currentScore)\n        }\n      });\n      \n      // Return the activity scores\n      return activityScores;\n    }\n    \n    /**\n     * Calculate overall score from dimension scores and activity scores\n     */\n    calculateOverallScore(dimensionScores, activityScores) {\n      // The dimensionScores object already contains an overall score based on dimensions\n      let overallScore = dimensionScores.overallScore;\n      \n      // If we have activity scores, factor them into the overall calculation\n      if (activityScores && Object.keys(activityScores).length > 0) {\n        // Calculate average activity score\n        const activityValues = Object.values(activityScores);\n        const avgActivityScore = activityValues.reduce((sum, activity) => {\n          return sum + activity.currentCapability; // Note: using currentCapability not currentScore\n        }, 0) / activityValues.length;\n        \n        // Blend the activity score with the dimension-based score\n        // We give slightly more weight to the dimension scores as they're more comprehensive\n        overallScore = Math.round((overallScore * 0.6) + (avgActivityScore * 0.4));\n      }\n      \n      return overallScore;\n    }\n  }\n  \n  // Export for use in assessment system\n  export default InhouseMarketingScoring;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMA,uBAAuB,CAAC;EACjCC,WAAWA,CAACC,MAAM,GAAG,CAAC,CAAC,EAAE;IACvB,IAAI,CAACA,MAAM,GAAGA,MAAM;;IAEpB;IACA,IAAI,CAACC,gBAAgB,GAAG;MACtBC,cAAc,EAAE,GAAG;MAAO;MAC1BC,kBAAkB,EAAE,GAAG;MAAI;MAC3BC,kBAAkB,EAAE,GAAG,CAAI;IAC7B,CAAC;;IAED;IACA,IAAI,CAACC,eAAe,GAAG;MACrBC,SAAS,EAAE,IAAI;MACfC,SAAS,EAAE,IAAI;MACfC,UAAU,EAAE,IAAI;MAChBC,SAAS,EAAE,GAAG,CAAE;IAClB,CAAC;;IAED;IACA,IAAI,CAACC,aAAa,GAAG;MACnBC,IAAI,EAAE;QACJC,UAAU,EAAE,GAAG;QAAS;QACxBC,SAAS,EAAE,EAAE;QAAW;QACxBC,UAAU,EAAE,CAAC,YAAY,EAAE,YAAY,CAAC;QACxCC,WAAW,EAAE,OAAO;QACpBC,UAAU,EAAE;UACVC,GAAG,EAAE,EAAE;UACPC,OAAO,EAAE,EAAE;UACXC,IAAI,EAAE;QACR;MACF,CAAC;MACDC,KAAK,EAAE;QACLR,UAAU,EAAE,GAAG;QAAS;QACxBC,SAAS,EAAE,GAAG;QAAU;QACxBC,UAAU,EAAE,CAAC,eAAe,EAAE,aAAa,CAAC;QAC5CC,WAAW,EAAE,SAAS;QACtBC,UAAU,EAAE;UACVC,GAAG,EAAE,EAAE;UACPC,OAAO,EAAE,EAAE;UACXC,IAAI,EAAE;QACR;MACF,CAAC;MACDE,MAAM,EAAE;QACNT,UAAU,EAAE,GAAG;QAAS;QACxBC,SAAS,EAAE,GAAG;QAAU;QACxBC,UAAU,EAAE,CAAC,gBAAgB,EAAE,uBAAuB,CAAC;QACvDC,WAAW,EAAE,UAAU;QACvBC,UAAU,EAAE;UACVC,GAAG,EAAE,EAAE;UACPC,OAAO,EAAE,EAAE;UACXC,IAAI,EAAE;QACR;MACF;IACF,CAAC;;IAED;IACA,IAAI,CAACG,cAAc,GAAG;MACpBC,iBAAiB,EAAE;QACjBC,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDC,YAAY,EAAE;QACZJ,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDE,eAAe,EAAE;QACfL,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDG,OAAO,EAAE;QACPN,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDI,cAAc,EAAE;QACdP,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDK,gBAAgB,EAAE;QAChBR,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDM,eAAe,EAAE;QACfT,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;MACDO,oBAAoB,EAAE;QACpBV,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB;IACF,CAAC;EACH;;EAEA;AACJ;AACA;AACA;AACA;AACA;EACIQ,eAAeA,CAACC,OAAO,EAAEC,QAAQ,EAAE;IACjC,MAAM;MAAEC,WAAW,GAAG,OAAO;MAAEC,kBAAkB,GAAG,EAAE;MAAEC;IAAO,CAAC,GAAGH,QAAQ;;IAE3E;IACA,MAAMI,cAAc,GAAG,IAAI,CAACC,uBAAuB,CAACN,OAAO,CAAC;;IAE5D;IACA,MAAMO,eAAe,GAAG,IAAI,CAACC,wBAAwB,CAACH,cAAc,CAAC;;IAErE;IACA,MAAMI,cAAc,GAAG,IAAI,CAACC,uBAAuB,CAACV,OAAO,EAAEG,kBAAkB,CAAC;;IAEhF;IACA,MAAMQ,YAAY,GAAG,IAAI,CAACC,qBAAqB,CAACL,eAAe,EAAEE,cAAc,CAAC;;IAEhF;IACA,MAAMI,aAAa,GAAG,IAAI,CAACC,kBAAkB,CAACH,YAAY,EAAET,WAAW,CAAC;;IAExE;IACA,MAAMa,QAAQ,GAAG,IAAI,CAACC,gBAAgB,CAACX,cAAc,EAAEI,cAAc,EAAET,OAAO,CAAC;;IAE/E;IACA,MAAMiB,cAAc,GAAG,IAAI,CAACC,iBAAiB,CAACL,aAAa,EAAEX,WAAW,CAAC;IACzE,MAAMiB,cAAc,GAAG,IAAI,CAACC,iBAAiB,CAACP,aAAa,EAAEX,WAAW,CAAC;;IAEzE;IACA,MAAMmB,gBAAgB,GAAG,IAAI,CAACC,yBAAyB,CACrDb,cAAc,EACdN,kBAAkB,EAClBD,WACF,CAAC;;IAED;IACA,MAAMqB,UAAU,GAAG,IAAI,CAACC,kBAAkB,CACxCnB,cAAc,EACdI,cAAc,EACdN,kBAAkB,EAClBD,WACF,CAAC;IAED,OAAO;MACLuB,OAAO,EAAEC,IAAI,CAACC,KAAK,CAACd,aAAa,CAAC;MAClCe,UAAU,EAAE;QACV9D,cAAc,EAAE4D,IAAI,CAACC,KAAK,CAACpB,eAAe,CAACzC,cAAc,CAAC;QAC1DC,kBAAkB,EAAE2D,IAAI,CAACC,KAAK,CAACpB,eAAe,CAACxC,kBAAkB,CAAC;QAClEC,kBAAkB,EAAE0D,IAAI,CAACC,KAAK,CAACpB,eAAe,CAACvC,kBAAkB;MACnE,CAAC;MACDqC,cAAc,EAAE;QACdnC,SAAS,EAAEwD,IAAI,CAACC,KAAK,CAACtB,cAAc,CAACnC,SAAS,CAAC;QAC/CC,SAAS,EAAEuD,IAAI,CAACC,KAAK,CAACtB,cAAc,CAAClC,SAAS,CAAC;QAC/CC,UAAU,EAAEsD,IAAI,CAACC,KAAK,CAACtB,cAAc,CAACjC,UAAU,CAAC;QACjDC,SAAS,EAAEqD,IAAI,CAACC,KAAK,CAACtB,cAAc,CAAChC,SAAS;MAChD,CAAC;MACDoC,cAAc,EAAEA,cAAc;MAC9BQ,cAAc,EAAEA,cAAc;MAC9BE,cAAc,EAAEA,cAAc;MAC9BE,gBAAgB,EAAEA,gBAAgB;MAClCE,UAAU,EAAEA,UAAU;MACtBR,QAAQ,EAAEA,QAAQ;MAClBb,WAAW,EAAEA,WAAW;MACxBC,kBAAkB,EAAEA,kBAAkB;MACtCC,MAAM,EAAEA,MAAM;MACdyB,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACpC,CAAC;EACH;;EAEA;AACJ;AACA;EACIzB,uBAAuBA,CAACN,OAAO,EAAE;IAC/B,MAAMgC,UAAU,GAAG;MACjB9D,SAAS,EAAE,EAAE;MACbC,SAAS,EAAE,EAAE;MACbC,UAAU,EAAE,EAAE;MACdC,SAAS,EAAE;IACb,CAAC;;IAED;IACA4D,MAAM,CAACC,OAAO,CAAClC,OAAO,CAAC,CAACmC,OAAO,CAAC,CAAC,CAACC,UAAU,EAAEC,MAAM,CAAC,KAAK;MACxD;MACA,MAAMC,KAAK,GAAG,OAAOD,MAAM,KAAK,QAAQ,GAAIA,MAAM,CAACC,KAAK,IAAID,MAAM,CAACE,KAAK,IAAI,CAAC,GAAIF,MAAM;;MAEvF;MACA,IAAID,UAAU,CAACI,QAAQ,CAAC,UAAU,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,WAAW,CAAC,IACnEJ,UAAU,CAACI,QAAQ,CAAC,iBAAiB,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,gBAAgB,CAAC,IAC/EJ,UAAU,CAACI,QAAQ,CAAC,iBAAiB,CAAC,EAAE;QAC1CR,UAAU,CAAC9D,SAAS,CAACuE,IAAI,CAACH,KAAK,CAAC;MAClC,CAAC,MAAM,IAAIF,UAAU,CAACI,QAAQ,CAAC,mBAAmB,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,QAAQ,CAAC,IACzEJ,UAAU,CAACI,QAAQ,CAAC,cAAc,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,iBAAiB,CAAC,IAC7EJ,UAAU,CAACI,QAAQ,CAAC,UAAU,CAAC,EAAE;QAC1CR,UAAU,CAAC7D,SAAS,CAACsE,IAAI,CAACH,KAAK,CAAC;MAClC,CAAC,MAAM,IAAIF,UAAU,CAACI,QAAQ,CAAC,YAAY,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,UAAU,CAAC,IACpEJ,UAAU,CAACI,QAAQ,CAAC,iBAAiB,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,0BAA0B,CAAC,IACzFJ,UAAU,CAACI,QAAQ,CAAC,gBAAgB,CAAC,EAAE;QAChDR,UAAU,CAAC5D,UAAU,CAACqE,IAAI,CAACH,KAAK,CAAC;MACnC,CAAC,MAAM,IAAIF,UAAU,CAACI,QAAQ,CAAC,kBAAkB,CAAC,IAAIJ,UAAU,CAACI,QAAQ,CAAC,cAAc,CAAC,EAAE;QACzFR,UAAU,CAAC3D,SAAS,CAACoE,IAAI,CAACH,KAAK,CAAC;MAClC;IACF,CAAC,CAAC;;IAEF;IACA,OAAO;MACLpE,SAAS,EAAE8D,UAAU,CAAC9D,SAAS,CAACwE,MAAM,GAAG,CAAC,GAAGV,UAAU,CAAC9D,SAAS,CAACyE,MAAM,CAAC,CAACC,GAAG,EAAEN,KAAK,KAAKM,GAAG,GAAGN,KAAK,EAAE,CAAC,CAAC,GAAGN,UAAU,CAAC9D,SAAS,CAACwE,MAAM,GAAG,EAAE,GAAG,EAAE;MAChJvE,SAAS,EAAE6D,UAAU,CAAC7D,SAAS,CAACuE,MAAM,GAAG,CAAC,GAAGV,UAAU,CAAC7D,SAAS,CAACwE,MAAM,CAAC,CAACC,GAAG,EAAEN,KAAK,KAAKM,GAAG,GAAGN,KAAK,EAAE,CAAC,CAAC,GAAGN,UAAU,CAAC7D,SAAS,CAACuE,MAAM,GAAG,EAAE,GAAG,EAAE;MAChJtE,UAAU,EAAE4D,UAAU,CAAC5D,UAAU,CAACsE,MAAM,GAAG,CAAC,GAAGV,UAAU,CAAC5D,UAAU,CAACuE,MAAM,CAAC,CAACC,GAAG,EAAEN,KAAK,KAAKM,GAAG,GAAGN,KAAK,EAAE,CAAC,CAAC,GAAGN,UAAU,CAAC5D,UAAU,CAACsE,MAAM,GAAG,EAAE,GAAG,EAAE;MACpJrE,SAAS,EAAE2D,UAAU,CAAC3D,SAAS,CAACqE,MAAM,GAAG,CAAC,GAAGV,UAAU,CAAC3D,SAAS,CAACsE,MAAM,CAAC,CAACC,GAAG,EAAEN,KAAK,KAAKM,GAAG,GAAGN,KAAK,EAAE,CAAC,CAAC,GAAGN,UAAU,CAAC3D,SAAS,CAACqE,MAAM,GAAG,EAAE,GAAG;IAChJ,CAAC;EACH;;EAEA;AACJ;AACA;EACI9B,qBAAqBA,CAACL,eAAe,EAAEE,cAAc,EAAE;IACrD;IACA,MAAMoC,cAAc,GAAGZ,MAAM,CAACa,MAAM,CAACrC,cAAc,CAAC;IACpD,MAAMsC,gBAAgB,GAAGF,cAAc,CAACH,MAAM,GAAG,CAAC,GAC9CG,cAAc,CAACF,MAAM,CAAC,CAACC,GAAG,EAAEI,QAAQ,KAAKJ,GAAG,GAAGI,QAAQ,CAACC,iBAAiB,EAAE,CAAC,CAAC,GAAGJ,cAAc,CAACH,MAAM,GACrG,EAAE;IAENnC,eAAe,CAACvC,kBAAkB,GAAG+E,gBAAgB;;IAErD;IACA,MAAMpC,YAAY,GAChBJ,eAAe,CAACzC,cAAc,GAAG,IAAI,CAACD,gBAAgB,CAACC,cAAc,GACrEyC,eAAe,CAACxC,kBAAkB,GAAG,IAAI,CAACF,gBAAgB,CAACE,kBAAkB,GAC7EgF,gBAAgB,GAAG,IAAI,CAAClF,gBAAgB,CAACG,kBAAkB;IAE7D,OAAO2C,YAAY;EACrB;;EAEA;AACJ;AACA;EACIG,kBAAkBA,CAACwB,KAAK,EAAEpC,WAAW,EAAE;IACrC,MAAMgD,QAAQ,GAAG,IAAI,CAAC5E,aAAa,CAAC4B,WAAW,CAAC;IAChD,IAAI,CAACgD,QAAQ,EAAE,OAAOZ,KAAK;;IAE3B;IACA,IAAIzB,aAAa,GAAGyB,KAAK,GAAGY,QAAQ,CAAC1E,UAAU;;IAE/C;IACA,IAAI0B,WAAW,KAAK,MAAM,IAAIoC,KAAK,GAAG,EAAE,EAAE;MACxC;MACAzB,aAAa,IAAI,CAAC;IACpB,CAAC,MAAM,IAAIX,WAAW,KAAK,QAAQ,IAAIoC,KAAK,GAAG,EAAE,EAAE;MACjD;MACAzB,aAAa,IAAI,CAAC;IACpB;;IAEA;IACA,OAAOa,IAAI,CAACyB,GAAG,CAAC,CAAC,EAAEzB,IAAI,CAAC0B,GAAG,CAAC,GAAG,EAAEvC,aAAa,CAAC,CAAC;EAClD;;EAEA;AACJ;AACA;EACIwC,kBAAkBA,CAACC,QAAQ,EAAEtD,OAAO,EAAE;IACpC;IACA;IACA,MAAMuD,OAAO,GAAG;MACdrF,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;MAAE;MACtCC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;MAAG;MACvCC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;MAAE;MACvCC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAG;IACzC,CAAC;IAED,OAAOkF,OAAO,CAACD,QAAQ,CAAC;EAC1B;;EAEA;AACJ;AACA;EACIpC,iBAAiBA,CAACoB,KAAK,EAAEpC,WAAW,EAAE;IACpC,MAAMtB,UAAU,GAAG,IAAI,CAACN,aAAa,CAAC4B,WAAW,CAAC,CAACtB,UAAU;IAE7D,IAAI0D,KAAK,IAAI1D,UAAU,CAACG,IAAI,EAAE;MAC5B,OAAO;QACLyE,KAAK,EAAE,MAAM;QACbC,KAAK,EAAE,sBAAsB;QAC7BC,WAAW,EAAE,8CAA8C;QAC3DC,KAAK,EAAE;MACT,CAAC;IACH,CAAC,MAAM,IAAIrB,KAAK,IAAI1D,UAAU,CAACE,OAAO,EAAE;MACtC,OAAO;QACL0E,KAAK,EAAE,QAAQ;QACfC,KAAK,EAAE,qBAAqB;QAC5BC,WAAW,EAAE,sCAAsC;QACnDC,KAAK,EAAE;MACT,CAAC;IACH,CAAC,MAAM,IAAIrB,KAAK,IAAI1D,UAAU,CAACC,GAAG,EAAE;MAClC,OAAO;QACL2E,KAAK,EAAE,KAAK;QACZC,KAAK,EAAE,aAAa;QACpBC,WAAW,EAAE,sCAAsC;QACnDC,KAAK,EAAE;MACT,CAAC;IACH,CAAC,MAAM;MACL,OAAO;QACLH,KAAK,EAAE,UAAU;QACjBC,KAAK,EAAE,sBAAsB;QAC7BC,WAAW,EAAE,kCAAkC;QAC/CC,KAAK,EAAE;MACT,CAAC;IACH;EACF;;EAEA;AACJ;AACA;EACIvC,iBAAiBA,CAACkB,KAAK,EAAEpC,WAAW,EAAE;IACpC,MAAMtB,UAAU,GAAG,IAAI,CAACN,aAAa,CAAC4B,WAAW,CAAC,CAACtB,UAAU;IAE7D,IAAIgF,UAAU;IACd,IAAItB,KAAK,IAAI1D,UAAU,CAACG,IAAI,EAAE;MAC5B6E,UAAU,GAAG,EAAE,GAAG,CAACtB,KAAK,GAAG1D,UAAU,CAACG,IAAI,KAAK,GAAG,GAAGH,UAAU,CAACG,IAAI,CAAC,GAAG,EAAE;IAC5E,CAAC,MAAM,IAAIuD,KAAK,IAAI1D,UAAU,CAACE,OAAO,EAAE;MACtC8E,UAAU,GAAG,EAAE,GAAG,CAACtB,KAAK,GAAG1D,UAAU,CAACE,OAAO,KAAKF,UAAU,CAACG,IAAI,GAAGH,UAAU,CAACE,OAAO,CAAC,GAAG,EAAE;IAC9F,CAAC,MAAM,IAAIwD,KAAK,IAAI1D,UAAU,CAACC,GAAG,EAAE;MAClC+E,UAAU,GAAG,EAAE,GAAG,CAACtB,KAAK,GAAG1D,UAAU,CAACC,GAAG,KAAKD,UAAU,CAACE,OAAO,GAAGF,UAAU,CAACC,GAAG,CAAC,GAAG,EAAE;IACzF,CAAC,MAAM;MACL+E,UAAU,GAAGtB,KAAK,GAAG1D,UAAU,CAACC,GAAG,GAAG,EAAE;IAC1C;IAEA,OAAO;MACL+E,UAAU,EAAElC,IAAI,CAACC,KAAK,CAACiC,UAAU,CAAC;MAClCC,UAAU,EAAE,mBAAmBnC,IAAI,CAACC,KAAK,CAACiC,UAAU,CAAC,gBAAgB1D,WAAW,kBAAkB;MAClG4D,KAAK,EAAEF,UAAU,GAAG,EAAE,GAAG,SAAS,GAAG,SAAS;MAC9CG,WAAW,EAAE,IAAI,CAACC,oBAAoB,CAACJ,UAAU;IACnD,CAAC;EACH;;EAEA;AACJ;AACA;EACItC,yBAAyBA,CAACb,cAAc,EAAEN,kBAAkB,EAAED,WAAW,EAAE;IACzE,MAAM+D,QAAQ,GAAG,IAAI,CAAC3F,aAAa,CAAC4B,WAAW,CAAC;IAChD,MAAMgE,YAAY,GAAGhE,WAAW,KAAK,MAAM,GAAG,EAAE,GAAGA,WAAW,KAAK,OAAO,GAAG,GAAG,GAAG,GAAG;IAEtF,IAAIiE,gBAAgB,GAAG,CAAC;IACxB,IAAIC,eAAe,GAAG,CAAC;IAEvBjE,kBAAkB,CAACgC,OAAO,CAACa,QAAQ,IAAI;MACrC,MAAMV,KAAK,GAAG7B,cAAc,CAACuC,QAAQ,CAAC;MACtC,IAAIV,KAAK,EAAE;QACT,MAAM+B,gBAAgB,GAAG/B,KAAK,CAACgC,qBAAqB,GAAG,GAAG;QAC1D,MAAMC,iBAAiB,GAAGjC,KAAK,CAACW,iBAAiB,GAAG,GAAG;QACvD,MAAMuB,iBAAiB,GAAGH,gBAAgB,GAAIE,iBAAiB,GAAGF,gBAAiB;;QAEnF;QACA,MAAMI,aAAa,GAAGP,YAAY,GAAG,IAAI,CAAC,CAAC;QAC3C,MAAMQ,UAAU,GAAGD,aAAa,GAAGD,iBAAiB;QAEpDJ,eAAe,IAAIM,UAAU;QAC7BP,gBAAgB,IAAIK,iBAAiB;MACvC;IACF,CAAC,CAAC;IAEF,MAAMG,cAAc,GAAGxE,kBAAkB,CAACuC,MAAM,GAAG,CAAC,GAChDyB,gBAAgB,GAAGhE,kBAAkB,CAACuC,MAAM,GAC5C,CAAC;IAEL,OAAO;MACLkC,gBAAgB,EAAElD,IAAI,CAACC,KAAK,CAACyC,eAAe,CAAC;MAC7CS,iBAAiB,EAAEnD,IAAI,CAACC,KAAK,CAACyC,eAAe,GAAG,CAAC,CAAC;MAClDU,mBAAmB,EAAEpD,IAAI,CAACC,KAAK,CAACgD,cAAc,GAAG,GAAG,CAAC;MACrDI,aAAa,EAAErD,IAAI,CAACC,KAAK,CAACyC,eAAe,GAAG,CAAC,GAAGH,QAAQ,CAACxF,SAAS,CAAC;MACnEuG,SAAS,EAAE,IAAI,CAACC,kBAAkB,CAAChB,QAAQ,CAACtF,WAAW,EAAEyF,eAAe,GAAG,CAAC,GAAGH,QAAQ,CAACxF,SAAS;IACnG,CAAC;EACH;;EAEA;AACJ;AACA;EACI+C,kBAAkBA,CAACnB,cAAc,EAAEI,cAAc,EAAEN,kBAAkB,EAAED,WAAW,EAAE;IAClF,MAAMqB,UAAU,GAAG,EAAE;;IAErB;IACA,IAAIlB,cAAc,CAACnC,SAAS,GAAG,EAAE,EAAE;MACjCqD,UAAU,CAACkB,IAAI,CAAC;QACdyC,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE,WAAW;QACjBC,OAAO,EAAE,MAAM;QACfC,MAAM,EAAE,gDAAgD;QACxDC,MAAM,EAAE;MACV,CAAC,CAAC;IACJ;IAEA,IAAIjF,cAAc,CAACjC,UAAU,GAAG,EAAE,EAAE;MAClCmD,UAAU,CAACkB,IAAI,CAAC;QACdyC,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE,YAAY;QAClBC,OAAO,EAAE,MAAM;QACfC,MAAM,EAAE,uCAAuC;QAC/CC,MAAM,EAAE;MACV,CAAC,CAAC;IACJ;;IAEA;IACArD,MAAM,CAACC,OAAO,CAACzB,cAAc,CAAC,CAAC0B,OAAO,CAAC,CAAC,CAACa,QAAQ,EAAEV,KAAK,CAAC,KAAK;MAC5D,IAAIA,KAAK,CAACiD,QAAQ,KAAK,MAAM,IAAIjD,KAAK,CAACkD,cAAc,GAAG,EAAE,EAAE;QAC1DjE,UAAU,CAACkB,IAAI,CAAC;UACdyC,IAAI,EAAE,UAAU;UAChBC,IAAI,EAAEnC,QAAQ;UACdoC,OAAO,EAAE,MAAM;UACfC,MAAM,EAAE,aAAa,IAAI,CAACI,kBAAkB,CAACzC,QAAQ,CAAC,UAAU;UAChEsC,MAAM,EAAE,QAAQhD,KAAK,CAACgC,qBAAqB;QAC7C,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;;IAEF;IACA,IAAIjE,cAAc,CAAChC,SAAS,GAAG,EAAE,EAAE;MACjCkD,UAAU,CAACkB,IAAI,CAAC;QACdyC,IAAI,EAAE,WAAW;QACjBC,IAAI,EAAE,YAAY;QAClBC,OAAO,EAAE,UAAU;QACnBC,MAAM,EAAE,0CAA0C;QAClDC,MAAM,EAAE;MACV,CAAC,CAAC;IACJ;;IAEA;IACA,MAAMrB,QAAQ,GAAG,IAAI,CAAC3F,aAAa,CAAC4B,WAAW,CAAC;IAChD+D,QAAQ,CAACvF,UAAU,CAACyD,OAAO,CAACuD,KAAK,IAAI;MACnC,IAAIA,KAAK,KAAK,YAAY,IAAInE,UAAU,CAACoE,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACV,IAAI,KAAK,UAAU,CAAC,CAACxC,MAAM,KAAK,CAAC,EAAE;QACxFnB,UAAU,CAACkB,IAAI,CAAC;UACdyC,IAAI,EAAE,WAAW;UACjBC,IAAI,EAAEO,KAAK;UACXN,OAAO,EAAE,QAAQ;UACjBC,MAAM,EAAE,iCAAiC;UACzCC,MAAM,EAAE;QACV,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;;IAEF;IACA,OAAO/D,UAAU,CACdsE,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;MACd,MAAMC,YAAY,GAAG;QAAEC,QAAQ,EAAE,CAAC;QAAElH,IAAI,EAAE,CAAC;QAAEE,MAAM,EAAE,CAAC;QAAEJ,GAAG,EAAE;MAAE,CAAC;MAChE,OAAOmH,YAAY,CAACF,CAAC,CAACV,OAAO,CAAC,GAAGY,YAAY,CAACD,CAAC,CAACX,OAAO,CAAC;IAC1D,CAAC,CAAC,CACDc,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAChB;;EAEA;AACJ;AACA;EACIlF,gBAAgBA,CAACX,cAAc,EAAEI,cAAc,EAAET,OAAO,EAAE;IAAA,IAAAmG,qBAAA;IACxD,MAAMpF,QAAQ,GAAG,EAAE;;IAEnB;IACA,IAAIV,cAAc,CAACnC,SAAS,GAAG,EAAE,EAAE;MACjC6C,QAAQ,CAAC0B,IAAI,CAAC;QACZyC,IAAI,EAAE,UAAU;QAChBkB,OAAO,EAAE,wEAAwE;QACjF9C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIjD,cAAc,CAACnC,SAAS,GAAG,EAAE,EAAE;MACxC6C,QAAQ,CAAC0B,IAAI,CAAC;QACZyC,IAAI,EAAE,KAAK;QACXkB,OAAO,EAAE,yEAAyE;QAClF9C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;;IAEA;IACA,IAAIjD,cAAc,CAAClC,SAAS,GAAG,EAAE,IAAIkC,cAAc,CAACnC,SAAS,GAAG,EAAE,EAAE;MAClE6C,QAAQ,CAAC0B,IAAI,CAAC;QACZyC,IAAI,EAAE,aAAa;QACnBkB,OAAO,EAAE,0EAA0E;QACnF9C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;;IAEA;IACA,MAAM+C,yBAAyB,GAAGpE,MAAM,CAACC,OAAO,CAACzB,cAAc,CAAC,CAC7DkF,MAAM,CAAC,CAAC,CAACW,CAAC,EAAEhE,KAAK,CAAC,KAAKA,KAAK,CAACkD,cAAc,GAAG,EAAE,CAAC,CACjDe,GAAG,CAAC,CAAC,CAACvD,QAAQ,CAAC,KAAKA,QAAQ,CAAC;IAEhC,IAAIqD,yBAAyB,CAAC3D,MAAM,GAAG,CAAC,EAAE;MACxC3B,QAAQ,CAAC0B,IAAI,CAAC;QACZyC,IAAI,EAAE,aAAa;QACnBkB,OAAO,EAAE,+BAA+B,IAAI,CAACX,kBAAkB,CAACY,yBAAyB,CAAC,CAAC,CAAC,CAAC,EAAE;QAC/F/C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;;IAEA;IACA,MAAMkD,YAAY,GAAG,EAAAL,qBAAA,GAAAnG,OAAO,CAACyG,iBAAiB,cAAAN,qBAAA,uBAAzBA,qBAAA,CAA2B7D,KAAK,KAAItC,OAAO,CAACyG,iBAAiB;IAClF,IAAID,YAAY,IAAI,CAAC,EAAE;MACrBzF,QAAQ,CAAC0B,IAAI,CAAC;QACZyC,IAAI,EAAE,UAAU;QAChBkB,OAAO,EAAE,oEAAoE;QAC7E9C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;IAEA,OAAOvC,QAAQ;EACjB;;EAEA;EACA2F,yBAAyBA,CAACpE,KAAK,EAAE;IAC/B,IAAIA,KAAK,IAAI,EAAE,EAAE,OAAO,MAAM;IAC9B,IAAIA,KAAK,IAAI,EAAE,EAAE,OAAO,QAAQ;IAChC,OAAO,KAAK;EACd;EAEAqE,yBAAyBA,CAAC1D,iBAAiB,EAAEqC,MAAM,EAAE;IACnD,MAAMsB,GAAG,GAAGtB,MAAM,CAAClG,mBAAmB,GAAG6D,iBAAiB;IAC1D,MAAM4D,IAAI,GAAG,GAAG,GAAGvB,MAAM,CAAChG,qBAAqB;IAC/C,MAAMiD,KAAK,GAAG+C,MAAM,CAACjG,YAAY;IAEjC,MAAMyH,aAAa,GAAIF,GAAG,GAAG,GAAG,GAAKC,IAAI,GAAG,GAAI,GAAItE,KAAK,GAAG,GAAI;IAEhE,IAAIuE,aAAa,GAAG,EAAE,EAAE,OAAO,MAAM;IACrC,IAAIA,aAAa,GAAG,EAAE,EAAE,OAAO,QAAQ;IACvC,OAAO,KAAK;EACd;EAEArB,kBAAkBA,CAACzC,QAAQ,EAAE;IAC3B,MAAM+D,KAAK,GAAG;MACZ5H,iBAAiB,EAAE,mBAAmB;MACtCK,YAAY,EAAE,cAAc;MAC5BC,eAAe,EAAE,iBAAiB;MAClCC,OAAO,EAAE,WAAW;MACpBC,cAAc,EAAE,uBAAuB;MACvCC,gBAAgB,EAAE,kBAAkB;MACpCC,eAAe,EAAE,mBAAmB;MACpCC,oBAAoB,EAAE;IACxB,CAAC;IACD,OAAOiH,KAAK,CAAC/D,QAAQ,CAAC,IAAIA,QAAQ;EACpC;EAEAgB,oBAAoBA,CAACJ,UAAU,EAAE;IAC/B,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,yCAAyC;IACtE,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,2CAA2C;IACxE,IAAIA,UAAU,IAAI,EAAE,EAAE,OAAO,2CAA2C;IACxE,OAAO,0CAA0C;EACnD;EAEAqB,kBAAkBA,CAACtG,WAAW,EAAEqI,cAAc,EAAE;IAC9C,MAAMC,SAAS,GAAGtI,WAAW,KAAK,OAAO,GAAG,EAAE,GAC5BA,WAAW,KAAK,SAAS,GAAG,GAAG,GAC/BA,WAAW,KAAK,UAAU,GAAG,IAAI,GAAG,GAAG;IAEzD,MAAMuI,MAAM,GAAGD,SAAS,GAAGD,cAAc;IAEzC,IAAIE,MAAM,GAAG,CAAC,EAAE,OAAO,eAAe;IACtC,IAAIA,MAAM,GAAG,CAAC,EAAE,OAAO,GAAGxF,IAAI,CAACyF,IAAI,CAACD,MAAM,CAAC,SAAS;IACpD,IAAIA,MAAM,GAAG,CAAC,EAAE,OAAO,YAAY;IACnC,OAAO,WAAW;EACpB;;EAEA;AACJ;AACA;EACI1G,wBAAwBA,CAACH,cAAc,EAAE;IACvC;IACA,MAAMvC,cAAc,GAAG,CACpBuC,cAAc,CAACnC,SAAS,GAAG,IAAI,CAACD,eAAe,CAACC,SAAS,GACzDmC,cAAc,CAACjC,UAAU,GAAG,IAAI,CAACH,eAAe,CAACG,UAAW,GAC5DiC,cAAc,CAAClC,SAAS,GAAG,IAAI,CAACF,eAAe,CAACE,SAAU,KACxD,IAAI,CAACF,eAAe,CAACC,SAAS,GAAG,IAAI,CAACD,eAAe,CAACG,UAAU,GAAG,IAAI,CAACH,eAAe,CAACE,SAAS,CAAC;;IAEvG;IACA,MAAMJ,kBAAkB,GAAGsC,cAAc,CAAChC,SAAS,GAAG,IAAI,CAACJ,eAAe,CAACI,SAAS;;IAEpF;;IAEA;IACA,OAAO;MACLP,cAAc,EAAE4D,IAAI,CAACC,KAAK,CAAC7D,cAAc,CAAC;MAC1CC,kBAAkB,EAAE2D,IAAI,CAACC,KAAK,CAAC5D,kBAAkB,CAAC;MAClDC,kBAAkB,EAAE,EAAE;MAAE;MACxB2C,YAAY,EAAEe,IAAI,CAACC,KAAK,CAAChB,YAAY,CAAC,CAAC;IACzC,CAAC;EACH;;EAEA;AACJ;AACA;EACID,uBAAuBA,CAACV,OAAO,EAAEG,kBAAkB,EAAE;IAAA,IAAAiH,qBAAA,EAAAC,qBAAA,EAAAC,qBAAA;IACnD,MAAM7G,cAAc,GAAG,CAAC,CAAC;;IAEzB;IACA,MAAM8G,aAAa,GAAG,EAAAH,qBAAA,GAAApH,OAAO,CAACwH,mBAAmB,cAAAJ,qBAAA,uBAA3BA,qBAAA,CAA6B9E,KAAK,KAAItC,OAAO,CAACwH,mBAAmB,IAAI,CAAC;IAC5F,MAAMC,gBAAgB,GAAG,EAAAJ,qBAAA,GAAArH,OAAO,CAAC0H,iBAAiB,cAAAL,qBAAA,uBAAzBA,qBAAA,CAA2B/E,KAAK,KAAItC,OAAO,CAAC0H,iBAAiB,IAAI,CAAC;IAC3F,MAAMC,WAAW,GAAG,EAAAL,qBAAA,GAAAtH,OAAO,CAAC4H,YAAY,cAAAN,qBAAA,uBAApBA,qBAAA,CAAsBhF,KAAK,KAAItC,OAAO,CAAC4H,YAAY,IAAI,CAAC;;IAE5E;IACAzH,kBAAkB,CAACgC,OAAO,CAACa,QAAQ,IAAI;MAAA,IAAA6E,QAAA;MACrC;MACA,MAAMvC,MAAM,GAAG,IAAI,CAACpG,cAAc,CAAC8D,QAAQ,CAAC,IAAI;QAC9C5D,mBAAmB,EAAE,EAAE;QACvBC,YAAY,EAAE,EAAE;QAChBC,qBAAqB,EAAE,EAAE;QACzBC,iBAAiB,EAAE;MACrB,CAAC;;MAED;MACA,MAAMuI,iBAAiB,GAAG,EAAAD,QAAA,GAAA7H,OAAO,CAAC,GAAGgD,QAAQ,aAAa,CAAC,cAAA6E,QAAA,uBAAjCA,QAAA,CAAmCvF,KAAK,KAC1CtC,OAAO,CAAC,GAAGgD,QAAQ,aAAa,CAAC,IACjCuE,aAAa;;MAErC;MACA,MAAMQ,YAAY,GAAID,iBAAiB,GAAG,CAAC,GAAI,GAAG;;MAElD;MACA,MAAMtC,cAAc,GAAGF,MAAM,CAAClG,mBAAmB,GAAG2I,YAAY;;MAEhE;MACA,MAAMC,YAAY,GAAG1C,MAAM,CAACjG,YAAY,IAAI,GAAG,GAAGiG,MAAM,CAAChG,qBAAqB,CAAC,GAAG,GAAG;;MAErF;MACA,MAAMiG,QAAQ,GAAG,IAAI,CAACoB,yBAAyB,CAACoB,YAAY,EAAEzC,MAAM,CAAC;;MAErE;MACA7E,cAAc,CAACuC,QAAQ,CAAC,GAAG;QACzB+E,YAAY,EAAErG,IAAI,CAACC,KAAK,CAACoG,YAAY,CAAC;QACtC9E,iBAAiB,EAAEvB,IAAI,CAACC,KAAK,CAACoG,YAAY,CAAC;QAAE;QAC7C3I,mBAAmB,EAAEkG,MAAM,CAAClG,mBAAmB;QAC/CoG,cAAc,EAAE9D,IAAI,CAACC,KAAK,CAAC6D,cAAc,CAAC;QAC1CyC,WAAW,EAAE3C,MAAM,CAACjG,YAAY;QAChC6I,oBAAoB,EAAE5C,MAAM,CAAChG,qBAAqB;QAClDC,iBAAiB,EAAE+F,MAAM,CAAC/F,iBAAiB;QAC3CyI,YAAY,EAAEtG,IAAI,CAACC,KAAK,CAACqG,YAAY,CAAC;QACtCzC,QAAQ,EAAEA,QAAQ;QAClBtE,cAAc,EAAE,IAAI,CAACyF,yBAAyB,CAACqB,YAAY;MAC7D,CAAC;IACH,CAAC,CAAC;;IAEF;IACA,OAAOtH,cAAc;EACvB;;EAEA;AACJ;AACA;EACIG,qBAAqBA,CAACL,eAAe,EAAEE,cAAc,EAAE;IACrD;IACA,IAAIE,YAAY,GAAGJ,eAAe,CAACI,YAAY;;IAE/C;IACA,IAAIF,cAAc,IAAIwB,MAAM,CAACkG,IAAI,CAAC1H,cAAc,CAAC,CAACiC,MAAM,GAAG,CAAC,EAAE;MAC5D;MACA,MAAMG,cAAc,GAAGZ,MAAM,CAACa,MAAM,CAACrC,cAAc,CAAC;MACpD,MAAMsC,gBAAgB,GAAGF,cAAc,CAACF,MAAM,CAAC,CAACC,GAAG,EAAEI,QAAQ,KAAK;QAChE,OAAOJ,GAAG,GAAGI,QAAQ,CAACC,iBAAiB,CAAC,CAAC;MAC3C,CAAC,EAAE,CAAC,CAAC,GAAGJ,cAAc,CAACH,MAAM;;MAE7B;MACA;MACA/B,YAAY,GAAGe,IAAI,CAACC,KAAK,CAAEhB,YAAY,GAAG,GAAG,GAAKoC,gBAAgB,GAAG,GAAI,CAAC;IAC5E;IAEA,OAAOpC,YAAY;EACrB;AACF;;AAEA;AACA,eAAejD,uBAAuB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}