{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport { AssessmentEngine } from '../engine/AssessmentEngine';\nexport const useAssessment = assessmentType => {\n  _s();\n  const [engine, setEngine] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentStage, setCurrentStage] = useState(null);\n  const [progress, setProgress] = useState(0);\n  useEffect(() => {\n    const initializeAssessment = async () => {\n      try {\n        setLoading(true);\n        const assessmentEngine = new AssessmentEngine(assessmentType);\n        await assessmentEngine.initialize();\n        setEngine(assessmentEngine);\n        setCurrentStage(assessmentEngine.flow.getCurrentStage());\n        updateProgress(assessmentEngine);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (assessmentType) {\n      initializeAssessment();\n    }\n  }, [assessmentType]);\n  const updateProgress = useCallback(assessmentEngine => {\n    const progressData = assessmentEngine.getProgress();\n    setProgress(progressData.percentage);\n  }, []);\n  const nextStage = useCallback(async () => {\n    if (!engine) return;\n    try {\n      const nextStage = await engine.nextStage();\n      setCurrentStage(nextStage);\n      updateProgress(engine);\n    } catch (err) {\n      setError(err.message);\n    }\n  }, [engine, updateProgress]);\n  const previousStage = useCallback(async () => {\n    if (!engine) return;\n    try {\n      const prevStage = await engine.previousStage();\n      setCurrentStage(prevStage);\n      updateProgress(engine);\n    } catch (err) {\n      setError(err.message);\n    }\n  }, [engine, updateProgress]);\n  const saveResponse = useCallback((questionId, value) => {\n    if (!engine) return;\n    engine.saveResponse(questionId, value);\n  }, [engine]);\n  const getResponse = useCallback(questionId => {\n    if (!engine) return null;\n    return engine.getResponse(questionId);\n  }, [engine]);\n  const setContext = useCallback((key, value) => {\n    if (!engine) return;\n    engine.setContext(key, value);\n  }, [engine]);\n  const getContext = useCallback(key => {\n    if (!engine) return null;\n    // Fixed critical bug: was using .key instead of [key]\n    // This was causing selectedServices to be undefined\n    console.log(`Getting context for key: ${key}`, engine.getContext());\n    return engine.getContext()[key];\n  }, [engine]);\n  const calculateResults = useCallback(() => {\n    if (!engine) return null;\n    return engine.calculateResults();\n  }, [engine]);\n  const getAssessmentConfig = useCallback(async type => {\n    try {\n      // Dynamically import the assessment configuration file\n      const config = await import(`../../assessments/${type}/config.json`);\n      return config;\n    } catch (err) {\n      console.error('Error loading assessment config:', err);\n      throw new Error(`Failed to load configuration for assessment type: ${type}`);\n    }\n  }, []);\n  const reset = useCallback(() => {\n    if (!engine) return;\n    engine.reset();\n    setCurrentStage(engine.flow.getCurrentStage());\n    setProgress(0);\n  }, [engine]);\n  return {\n    loading,\n    error,\n    currentStage,\n    progress,\n    nextStage,\n    previousStage,\n    saveResponse,\n    getResponse,\n    setContext,\n    getContext,\n    calculateResults,\n    reset,\n    getAssessmentConfig\n  };\n};\n_s(useAssessment, \"ygapTP3HOzhXnV4L3u3aHSUDOKk=\");\nexport default useAssessment;","map":{"version":3,"names":["useState","useEffect","useCallback","AssessmentEngine","useAssessment","assessmentType","_s","engine","setEngine","loading","setLoading","error","setError","currentStage","setCurrentStage","progress","setProgress","initializeAssessment","assessmentEngine","initialize","flow","getCurrentStage","updateProgress","err","message","progressData","getProgress","percentage","nextStage","previousStage","prevStage","saveResponse","questionId","value","getResponse","setContext","key","getContext","console","log","calculateResults","getAssessmentConfig","type","config","Error","reset"],"sources":["/Users/jon/Documents/GitHub/assessor/src/core/hooks/useAssessment.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { AssessmentEngine } from '../engine/AssessmentEngine';\n\nexport const useAssessment = (assessmentType) => {\n    const [engine, setEngine] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [currentStage, setCurrentStage] = useState(null);\n    const [progress, setProgress] = useState(0);\n\n    useEffect(() => {\n        const initializeAssessment = async () => {\n            try {\n                setLoading(true);\n                const assessmentEngine = new AssessmentEngine(assessmentType);\n                await assessmentEngine.initialize();\n                setEngine(assessmentEngine);\n                setCurrentStage(assessmentEngine.flow.getCurrentStage());\n                updateProgress(assessmentEngine);\n            } catch (err) {\n                setError(err.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        if (assessmentType) {\n            initializeAssessment();\n        }\n    }, [assessmentType]);\n\n    const updateProgress = useCallback((assessmentEngine) => {\n        const progressData = assessmentEngine.getProgress();\n        setProgress(progressData.percentage);\n    }, []);\n\n    const nextStage = useCallback(async () => {\n        if (!engine) return;\n        \n        try {\n            const nextStage = await engine.nextStage();\n            setCurrentStage(nextStage);\n            updateProgress(engine);\n        } catch (err) {\n            setError(err.message);\n        }\n    }, [engine, updateProgress]);\n\n    const previousStage = useCallback(async () => {\n        if (!engine) return;\n        \n        try {\n            const prevStage = await engine.previousStage();\n            setCurrentStage(prevStage);\n            updateProgress(engine);\n        } catch (err) {\n            setError(err.message);\n        }\n    }, [engine, updateProgress]);\n\n    const saveResponse = useCallback((questionId, value) => {\n        if (!engine) return;\n        engine.saveResponse(questionId, value);\n    }, [engine]);\n\n    const getResponse = useCallback((questionId) => {\n        if (!engine) return null;\n        return engine.getResponse(questionId);\n    }, [engine]);\n\n    const setContext = useCallback((key, value) => {\n        if (!engine) return;\n        engine.setContext(key, value);\n    }, [engine]);\n\n    const getContext = useCallback((key) => {\n        if (!engine) return null;\n        // Fixed critical bug: was using .key instead of [key]\n        // This was causing selectedServices to be undefined\n        console.log(`Getting context for key: ${key}`, engine.getContext());\n        return engine.getContext()[key];\n    }, [engine]);\n\n    const calculateResults = useCallback(() => {\n        if (!engine) return null;\n        return engine.calculateResults();\n    }, [engine]);\n\n    const getAssessmentConfig = useCallback(async (type) => {\n        try {\n            // Dynamically import the assessment configuration file\n            const config = await import(`../../assessments/${type}/config.json`);\n            return config;\n        } catch (err) {\n            console.error('Error loading assessment config:', err);\n            throw new Error(`Failed to load configuration for assessment type: ${type}`);\n        }\n    }, []);\n\n    const reset = useCallback(() => {\n        if (!engine) return;\n        engine.reset();\n        setCurrentStage(engine.flow.getCurrentStage());\n        setProgress(0);\n    }, [engine]);\n\n    return {\n        loading,\n        error,\n        currentStage,\n        progress,\n        nextStage,\n        previousStage,\n        saveResponse,\n        getResponse,\n        setContext,\n        getContext,\n        calculateResults,\n        reset,\n        getAssessmentConfig\n    };\n};\n\nexport default useAssessment;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}